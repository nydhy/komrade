import{r as c,o as p,j as s,y as m,z as j}from"./index-D52GenFk.js";function o(a){switch(a){case"HIGH":return"severity-high";case"MED":return"severity-med";case"LOW":return"severity-low";default:return""}}function y(){const[a,i]=c.useState([]),[x,h]=c.useState(!0);async function g(){try{const e=await m(50);i(e)}catch{}finally{h(!1)}}c.useEffect(()=>{g()},[]),p(["sos.recipient_updated","sos.closed"],()=>{m(50).then(i).catch(()=>{})});async function u(e){try{const n=await j(e);i(t=>t.map(r=>r.id===e?n:r))}catch{}}if(x)return s.jsxs("div",{className:"page-container animate-in",children:[s.jsx("h1",{className:"heading-lg text-gradient",children:"SOS History"}),s.jsx("div",{className:"card loading-shimmer skeleton-card mt-6"})]});const d=a.filter(e=>e.status!=="CLOSED"),l=a.filter(e=>e.status==="CLOSED");return s.jsxs("div",{className:"page-container animate-in",children:[s.jsx("h1",{className:"heading-lg text-gradient mb-6",children:"SOS History"}),a.length===0?s.jsx("div",{className:"card",children:s.jsx("p",{className:"text-muted text-sm text-center",children:"No SOS alerts yet."})}):s.jsxs(s.Fragment,{children:[d.length>0&&s.jsxs("section",{className:"mb-6",children:[s.jsx("h2",{className:"heading-md mb-4",children:"Active Alerts"}),s.jsx("div",{className:"flex-col gap-md",children:d.map((e,n)=>s.jsxs("div",{className:`card ${o(e.severity)} sos-pulse animate-in animate-in-delay-${Math.min(n,4)}`,children:[s.jsxs("div",{className:"flex-between",children:[s.jsxs("div",{className:"flex-center gap-sm",children:[s.jsx("span",{className:"status-dot status-dot-danger"}),s.jsxs("strong",{className:"heading-sm",children:["SOS #",e.id," — ",e.trigger_type," / ",e.severity]}),s.jsx("span",{className:"badge badge-danger",children:e.status})]}),s.jsx("button",{type:"button",onClick:()=>u(e.id),className:"btn btn-ghost btn-sm",children:"Close"})]}),s.jsxs("p",{className:"text-secondary text-sm mt-3",children:["Recipients: ",e.recipients.map(t=>`${t.buddy_name} (${t.status})`).join(", ")]}),s.jsxs("p",{className:"text-muted text-xs mt-1",children:["Created: ",new Date(e.created_at).toLocaleString()]})]},e.id))})]}),l.length>0&&s.jsxs("section",{children:[s.jsx("h2",{className:"heading-md mb-4",children:"Closed Alerts"}),s.jsx("div",{className:"flex-col gap-md",children:l.map((e,n)=>s.jsxs("div",{className:`card ${o(e.severity)} animate-in animate-in-delay-${Math.min(n,4)}`,children:[s.jsx("div",{className:"flex-between",children:s.jsxs("div",{className:"flex-center gap-sm",children:[s.jsx("span",{className:"status-dot status-dot-offline"}),s.jsxs("strong",{className:"heading-sm",children:["SOS #",e.id," — ",e.trigger_type," / ",e.severity]}),s.jsx("span",{className:"badge",children:e.status})]})}),s.jsxs("p",{className:"text-secondary text-sm mt-3",children:["Recipients: ",e.recipients.map(t=>`${t.buddy_name} (${t.status})`).join(", ")]}),s.jsxs("p",{className:"text-muted text-xs mt-1",children:["Created: ",new Date(e.created_at).toLocaleString(),e.closed_at&&` · Closed: ${new Date(e.closed_at).toLocaleString()}`]})]},e.id))})]})]})]})}export{y as default};
