import{r as a,j as e}from"./index-D1iaHaPw.js";import{g as N,u as f}from"./settings-DlxSDRwg.js";function q(){const[y,d]=a.useState(null),[p,j]=a.useState(!0),[o,u]=a.useState(!1),[m,n]=a.useState(null),[b,i]=a.useState(!1),[l,c]=a.useState(""),[h,r]=a.useState(""),[g,x]=a.useState(!0);async function S(){try{const s=await N();d(s),c(s.quiet_hours_start??""),r(s.quiet_hours_end??""),x(s.share_precise_location)}catch(s){n(s instanceof Error?s.message:"Failed to load settings")}finally{j(!1)}}a.useEffect(()=>{S()},[]);async function v(s){s.preventDefault(),u(!0),n(null),i(!1);try{const t=await f({quiet_hours_start:l||null,quiet_hours_end:h||null,share_precise_location:g});d(t),i(!0),setTimeout(()=>i(!1),3e3)}catch(t){n(t instanceof Error?t.message:"Failed to save settings")}finally{u(!1)}}return p?e.jsx("div",{className:"page-container flex-center",style:{minHeight:"40vh"},children:e.jsx("p",{className:"text-secondary",children:"Loading settings..."})}):e.jsxs("div",{className:"page-container page-container-narrow",children:[e.jsxs("div",{className:"animate-in mb-8",children:[e.jsx("h1",{className:"heading-lg mb-2",children:"Settings"}),e.jsx("p",{className:"text-muted",children:"Manage your preferences and privacy"})]}),m&&e.jsx("div",{className:"alert alert-danger animate-in mb-4",children:m}),b&&e.jsx("div",{className:"alert alert-success animate-in mb-4",children:"Settings saved successfully."}),e.jsxs("form",{onSubmit:v,className:"flex-col gap-lg",children:[e.jsxs("section",{className:"card animate-in animate-in-delay-1",children:[e.jsx("h2",{className:"heading-md mb-2",children:"Quiet Hours"}),e.jsx("p",{className:"text-muted text-sm mb-4",children:"During quiet hours, you won't be selected as an SOS recipient."}),e.jsx("div",{className:"divider mb-4"}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"input-group",children:[e.jsx("label",{children:"Start"}),e.jsx("input",{type:"time",className:"input",value:l,onChange:s=>c(s.target.value)})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{children:"End"}),e.jsx("input",{type:"time",className:"input",value:h,onChange:s=>r(s.target.value)})]})]}),l&&e.jsx("div",{className:"mt-3",children:e.jsx("button",{type:"button",className:"btn btn-ghost btn-sm",onClick:()=>{c(""),r("")},children:"Clear quiet hours"})})]}),e.jsxs("section",{className:"card animate-in animate-in-delay-2",children:[e.jsx("h2",{className:"heading-md mb-2",children:"Location Privacy"}),e.jsx("p",{className:"text-muted text-sm mb-4",children:"When disabled, buddies see approximate location only until they accept an SOS."}),e.jsx("div",{className:"divider mb-4"}),e.jsxs("label",{className:"checkbox-toggle",children:[e.jsx("input",{type:"checkbox",checked:g,onChange:s=>x(s.target.checked)}),e.jsx("span",{className:"toggle-track"}),e.jsx("span",{className:"toggle-label",children:"Share precise location"})]})]}),e.jsx("div",{className:"animate-in animate-in-delay-3",children:e.jsx("button",{type:"submit",className:"btn btn-primary btn-lg",disabled:o,children:o?"Saving...":"Save Settings"})})]})]})}export{q as default};
